response_data = {
    "patientlist": [
        {
            "patient": {
                "patientId": "Aly Artery",
                "anonymizedPatientId": "parakeet_demo_4012617",
                "patientName": "Aly Artery",
                "gender": "F",
                "dateOfBirth": "1957-05-08",
                "lastModified": "2024-06-12 10:39:18.093577",
                "studyList": [
                    {
                        "studyInstanceUid": "1.2.124.113532.80.22170.59678.20200308.20702.28429333",
                        "studyDateTime": "2021-05-01 02:47:26",
                        "accessionNumber": "1050000454534",
                        "studyDescription": "CT CHEST PULMONARY EMBOLISM W CONTRAST",
                        "seriesList": [
                            {
                                "seriesDateTime": "2021-05-01 02:50:16",
                                "seriesInstanceUid": "1.2.840.113619.2.334.3.202042139.517.1583372598.147.3",
                                "seriesDescription": "CHEST PE",
                                "seriesNumber": "3",
                                "rapidseriesid": "14",
                                "numberOfImages": 0
                            }
                        ]
                    }
                ]
            },
            "patienttasklist": [
                {
                    "scheduleddatetime": "2024-06-12 10:34:55.82278",
                    "startdatetime": "2024-06-12 10:34:55.825873",
                    "enddatetime": "2024-06-12 10:34:56.491608",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomImport",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 186,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:34:56.432689",
                    "startdatetime": "2024-06-12 10:34:56.441603",
                    "enddatetime": "2024-06-12 10:37:17.285949",
                    "taskstatus": "SUCCESS",
                    "modulename": "PETN",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 187,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:34:56.481745",
                    "startdatetime": "2024-06-12 10:37:17.297904",
                    "enddatetime": "2024-06-12 10:39:18.091262",
                    "taskstatus": "SUCCESS",
                    "modulename": "RVLV",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 188,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:16.916135",
                    "startdatetime": "2024-06-12 10:37:16.931948",
                    "enddatetime": "2024-06-12 10:37:17.155016",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 189,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:16.924713",
                    "startdatetime": "2024-06-12 10:37:16.933976",
                    "enddatetime": "2024-06-12 10:37:17.213812",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 190,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:17.259062",
                    "startdatetime": "2024-06-12 10:37:17.265902",
                    "enddatetime": "2024-06-12 10:37:19.268923",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 191,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:17.270275",
                    "startdatetime": "2024-06-12 10:37:17.277916",
                    "enddatetime": "2024-06-12 10:37:19.25086",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 192,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:17.723895",
                    "startdatetime": "2024-06-12 10:39:17.731437",
                    "enddatetime": "2024-06-12 10:39:17.811294",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 194,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:17.734805",
                    "startdatetime": "2024-06-12 10:39:17.742598",
                    "enddatetime": "2024-06-12 10:39:17.893026",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 195,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:18.059215",
                    "startdatetime": "2024-06-12 10:39:18.06543",
                    "enddatetime": "2024-06-12 10:39:20.011307",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 196,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:18.070018",
                    "startdatetime": "2024-06-12 10:39:18.077461",
                    "enddatetime": "2024-06-12 10:39:19.789309",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 197,
                    "taskdescription": "Task is successful"
                }
            ]
        },
        {
            "patient": {
                "patientId": "May Laura",
                "anonymizedPatientId": "parakeet_demo_4012617",
                "patientName": "Aly Artery",
                "gender": "F",
                "dateOfBirth": "1957-05-08",
                "lastModified": "2024-06-12 10:39:18.093577",
                "studyList": [
                    {
                        "studyInstanceUid": "1.2.124.113532.80.22170.59678.20200308.20702.28429333",
                        "studyDateTime": "2021-05-01 02:47:26",
                        "accessionNumber": "1050000454534",
                        "studyDescription": "CT CHEST PULMONARY EMBOLISM W CONTRAST",
                        "seriesList": [
                            {
                                "seriesDateTime": "2021-05-01 02:50:16",
                                "seriesInstanceUid": "1.2.840.113619.2.334.3.202042139.517.1583372598.147.3",
                                "seriesDescription": "CHEST PE",
                                "seriesNumber": "3",
                                "rapidseriesid": "14",
                                "numberOfImages": 0
                            }
                        ]
                    }
                ]
            },
            "patienttasklist": [
                {
                    "scheduleddatetime": "2024-06-12 10:34:55.82278",
                    "startdatetime": "2024-06-12 10:34:55.825873",
                    "enddatetime": "2024-06-12 10:34:56.491608",
                    "taskstatus": "RUNNING",
                    "modulename": "DicomImport",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 186,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:34:56.432689",
                    "startdatetime": "2024-06-12 10:34:56.441603",
                    "enddatetime": "2024-06-12 10:37:17.285949",
                    "taskstatus": "SUCCESS",
                    "modulename": "PETN",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 187,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:34:56.481745",
                    "startdatetime": "2024-06-12 10:37:17.297904",
                    "enddatetime": "2024-06-12 10:39:18.091262",
                    "taskstatus": "SUCCESS",
                    "modulename": "RVLV",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 188,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:16.916135",
                    "startdatetime": "2024-06-12 10:37:16.931948",
                    "enddatetime": "2024-06-12 10:37:17.155016",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 189,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:16.924713",
                    "startdatetime": "2024-06-12 10:37:16.933976",
                    "enddatetime": "2024-06-12 10:37:17.213812",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 190,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:17.259062",
                    "startdatetime": "2024-06-12 10:37:17.265902",
                    "enddatetime": "2024-06-12 10:37:19.268923",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 191,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:17.270275",
                    "startdatetime": "2024-06-12 10:37:17.277916",
                    "enddatetime": "2024-06-12 10:37:19.25086",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 192,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:17.723895",
                    "startdatetime": "2024-06-12 10:39:17.731437",
                    "enddatetime": "2024-06-12 10:39:17.811294",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 194,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:17.734805",
                    "startdatetime": "2024-06-12 10:39:17.742598",
                    "enddatetime": "2024-06-12 10:39:17.893026",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 195,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:18.059215",
                    "startdatetime": "2024-06-12 10:39:18.06543",
                    "enddatetime": "2024-06-12 10:39:20.011307",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 196,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:18.070018",
                    "startdatetime": "2024-06-12 10:39:18.077461",
                    "enddatetime": "2024-06-12 10:39:19.789309",
                    "taskstatus": "SCHEDULED",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 197,
                    "taskdescription": "Task is successful"
                }
            ]
        },
        {
            "patient": {
                "patientId": "Carla Davis",
                "anonymizedPatientId": "parakeet_demo_4012617",
                "patientName": "Aly Artery",
                "gender": "F",
                "dateOfBirth": "1957-05-08",
                "lastModified": "2024-06-12 10:39:18.093577",
                "studyList": [
                    {
                        "studyInstanceUid": "1.2.124.113532.80.22170.59678.20200308.20702.28429333",
                        "studyDateTime": "2021-05-01 02:47:26",
                        "accessionNumber": "1050000454534",
                        "studyDescription": "CT CHEST PULMONARY EMBOLISM W CONTRAST",
                        "seriesList": [
                            {
                                "seriesDateTime": "2021-05-01 02:50:16",
                                "seriesInstanceUid": "1.2.840.113619.2.334.3.202042139.517.1583372598.147.3",
                                "seriesDescription": "CHEST PE",
                                "seriesNumber": "3",
                                "rapidseriesid": "14",
                                "numberOfImages": 0
                            }
                        ]
                    }
                ]
            },
            "patienttasklist": [
                {
                    "scheduleddatetime": "2024-06-12 10:34:55.82278",
                    "startdatetime": "2024-06-12 10:34:55.825873",
                    "enddatetime": "2024-06-12 10:34:56.491608",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomImport",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 186,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:34:56.432689",
                    "startdatetime": "2024-06-12 10:34:56.441603",
                    "enddatetime": "2024-06-12 10:37:17.285949",
                    "taskstatus": "SUCCESS",
                    "modulename": "PETN",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 187,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:34:56.481745",
                    "startdatetime": "2024-06-12 10:37:17.297904",
                    "enddatetime": "2024-06-12 10:39:18.091262",
                    "taskstatus": "SUCCESS",
                    "modulename": "RVLV",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 188,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:16.916135",
                    "startdatetime": "2024-06-12 10:37:16.931948",
                    "enddatetime": "2024-06-12 10:37:17.155016",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 189,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:16.924713",
                    "startdatetime": "2024-06-12 10:37:16.933976",
                    "enddatetime": "2024-06-12 10:37:17.213812",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 190,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:17.259062",
                    "startdatetime": "2024-06-12 10:37:17.265902",
                    "enddatetime": "2024-06-12 10:37:19.268923",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 191,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:37:17.270275",
                    "startdatetime": "2024-06-12 10:37:17.277916",
                    "enddatetime": "2024-06-12 10:37:19.25086",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 192,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:17.723895",
                    "startdatetime": "2024-06-12 10:39:17.731437",
                    "enddatetime": "2024-06-12 10:39:17.811294",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 194,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:17.734805",
                    "startdatetime": "2024-06-12 10:39:17.742598",
                    "enddatetime": "2024-06-12 10:39:17.893026",
                    "taskstatus": "SUCCESS",
                    "modulename": "DicomSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 195,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:18.059215",
                    "startdatetime": "2024-06-12 10:39:18.06543",
                    "enddatetime": "2024-06-12 10:39:20.011307",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 196,
                    "taskdescription": "Task is successful"
                },
                {
                    "scheduleddatetime": "2024-06-12 10:39:18.070018",
                    "startdatetime": "2024-06-12 10:39:18.077461",
                    "enddatetime": "2024-06-12 10:39:19.789309",
                    "taskstatus": "SUCCESS",
                    "modulename": "emailSend",
                    "taskscode": 0,
                    "rapidseriesid": "14",
                    "taskid": 197,
                    "taskdescription": "Task is successful"
                }
            ]
        }
    ]
}
from datetime import datetime

patientlist = response_data.get("patientlist", [])
running_task_found = False
if len(patientlist) > 0:
    # print(f"Length of patientlist is {len(patientlist)}")
    for patient in patientlist:
        if "patienttasklist" in patient:
            patienttasklist = patient["patienttasklist"]
            for patienttask in patienttasklist:
                if patienttask['taskstatus'] == "RUNNING":
                    print(
                        f"taskstatus: {patienttask['taskstatus']}, patientId: {patient['patient']['patientId']}, patientName: {patient['patient']['patientName']}, modulename: {patienttask['modulename']}, taskid: {patienttask['taskid']}, scheduleddatetime: {patienttask['scheduleddatetime']}, startdatetime: {patienttask['startdatetime']}")
                elif patienttask['taskstatus'] == "SCHEDULED":
                    print(
                        f"taskstatus: {patienttask['taskstatus']}, patientId: {patient['patient']['patientId']}, patientName: {patient['patient']['patientName']}, modulename: {patienttask['modulename']}, taskid: {patienttask['taskid']}, scheduleddatetime: {patienttask['scheduleddatetime']}")
                else:
                    startdatetime = patienttask['startdatetime']
                    enddatetime = patienttask['enddatetime']

                    # Convert strings to datetime objects
                    start_dt = datetime.strptime(startdatetime, "%Y-%m-%d %H:%M:%S.%f")
                    end_dt = datetime.strptime(enddatetime, "%Y-%m-%d %H:%M:%S.%f")

                    # Calculate the difference
                    time_difference = str(end_dt - start_dt)

                    print(
                        f"taskstatus: {patienttask['taskstatus']}, patientId: {patient['patient']['patientId']}, patientName: {patient['patient']['patientName']}, modulename: {patienttask['modulename']}, taskid: {patienttask['taskid']}, scheduleddatetime: {patienttask['scheduleddatetime']}, startdatetime: {patienttask['startdatetime']}, enddatetime: {patienttask['enddatetime']}, time_difference: {time_difference}")
        print("\n")
    for patient in patientlist:
        if "patienttasklist" in patient:
            patienttasklist = patient["patienttasklist"]
            for patienttask in patienttasklist:
                if patienttask.get("taskstatus", "") == "RUNNING" or patienttask.get("taskstatus", "") == "SCHEDULED":
                    print("Image Processing is still going On")
                    running_task_found = True
                    break # Exits the innermost for loop
        if running_task_found:
            break # as running_task_found = True no need to check other patients

if not running_task_found:
    print("Every module's Image Processing completed")
    # break  # Exits the while loop
